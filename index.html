// 修正后的访问量统计逻辑
document.addEventListener('DOMContentLoaded', function() {
    // 更新总访问量
    visits.total = (visits.total || 0) + 1;
    console.log("📊 更新访问量 - 总访问量:", visits.total);
    
    // 更新每日访问量
    const today = new Date().toLocaleDateString();
    visits.daily[today] = (visits.daily[today] || 0) + 1;
    console.log("📊 更新访问量 - 今日访问量:", visits.daily[today]);
    
    // 保存到localStorage
    localStorage.setItem('siteVisits', JSON.stringify(visits));
    console.log("💾 访问量已保存到localStorage:", visits);
    
    // 同步到阿里云FC
    syncConfigToFC({
        pageStatusConfig: window.pageStatusConfig || pageStatusConfig,
        pagePasswords: window.pagePasswords || pagePasswords,
        adminAccounts: window.adminAccounts || adminAccounts,
        messages: window.messages || messages,
        adminLogs: window.logs || logs,
        siteVisits: window.visits || visits, // 确保传递正确的访问量数据
        timestamp: new Date().toISOString()
    }).then(() => {
        console.log('📊 访问量已同步到阿里云 FC');
    }).catch((error) => {
        console.error('❌ 访问量同步到阿里云 FC 失败:', error);
    });
    
    // ... (其他初始化代码)
});
